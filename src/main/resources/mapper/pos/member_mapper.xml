<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ustore.pos.dao.PosDao">

		<!-- 현재 멤버쉽 이용 회원 리스트 -->
		<select id="posMember" resultType="com.ustore.member.dto.MemberDto">
			   SELECT m.member_idx , m.name ,m.contact_num, mg.grade, c2.common_type 
			   FROM members m
			   LEFT JOIN member_grade mg ON m.grade_idx = mg.grade_idx
			   LEFT JOIN common c2 ON m.member_type = c2.common_idx 
			   WHERE m.member_state = (SELECT c.common_idx FROM common c WHERE common_type='등록된 회원')
		</select>
		
		<!-- 현재 멤버쉽 이용 회원 리스트 검색 -->
		<select id="memberSearch" resultType="com.ustore.member.dto.MemberDto">
			SELECT m.member_idx , m.name ,m.contact_num, mg.grade, c2.common_type 
			FROM members m
			LEFT JOIN member_grade mg ON m.grade_idx = mg.grade_idx
			LEFT JOIN common c2 ON m.member_type = c2.common_idx 
			WHERE m.member_state = (SELECT c.common_idx FROM common c WHERE common_type='등록된 회원')
			AND
			<if test="selectedOption == 'name'">	  	
		   	 m.name =#{searchText}
	  		</if>
	  		<if test="selectedOption == 'contact_num'">
			m.contact_num LIKE CONCAT('%', #{searchText})
			</if>
		</select>
		













</mapper>